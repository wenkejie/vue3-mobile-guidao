import{ai as z,ar as R,T as k,S as b,aj as N,r as i,b7 as A,aO as W,b8 as Y,ag as ee,w as g,b9 as te,X as p,K,d as X,an as $,g as h,ba as F,az as oe,V as M,E as j,O as H,$ as V,a0 as x,c as ne,J as ae,q as se,bb as le,a6 as ce,bc as re,aw as ie,F as ue,bd as de,Y as ve,P as _,Q as fe,I as ye}from"./index-Ti0Ywde6.js";function he(e){const t=R();t&&z(t.proxy,e)}const me={show:Boolean,zIndex:k,overlay:b,duration:k,teleport:[String,Object],lockScroll:b,lazyRender:b,beforeClose:Function,overlayStyle:Object,overlayClass:N,transitionAppear:Boolean,closeOnClickOverlay:b};function Ie(e,t){return e>t?"horizontal":t>e?"vertical":""}function Oe(){const e=i(0),t=i(0),o=i(0),r=i(0),n=i(0),l=i(0),a=i(""),c=i(!0),C=()=>a.value==="vertical",O=()=>a.value==="horizontal",u=()=>{o.value=0,r.value=0,n.value=0,l.value=0,a.value="",c.value=!0};return{move:d=>{const v=d.touches[0];o.value=(v.clientX<0?0:v.clientX)-e.value,r.value=v.clientY-t.value,n.value=Math.abs(o.value),l.value=Math.abs(r.value);const I=10;(!a.value||n.value<I&&l.value<I)&&(a.value=Ie(n.value,l.value)),c.value&&(n.value>A||l.value>A)&&(c.value=!1)},start:d=>{u(),e.value=d.touches[0].clientX,t.value=d.touches[0].clientY},reset:u,startX:e,startY:t,deltaX:o,deltaY:r,offsetX:n,offsetY:l,direction:a,isVertical:C,isHorizontal:O,isTap:c}}let w=0;const D="van-overflow-hidden";function be(e,t){const o=Oe(),r="01",n="10",l=u=>{o.move(u);const m=o.deltaY.value>0?n:r,P=te(u.target,e.value),{scrollHeight:d,offsetHeight:v,scrollTop:I}=P;let f="11";I===0?f=v>=d?"00":"01":I+v>=d&&(f="10"),f!=="11"&&o.isVertical()&&!(parseInt(f,2)&parseInt(m,2))&&p(u,!0)},a=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",l,{passive:!1}),w||document.body.classList.add(D),w++},c=()=>{w&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",l),w--,w||document.body.classList.remove(D))},C=()=>t()&&a(),O=()=>t()&&c();W(C),Y(O),ee(O),g(t,u=>{u?a():c()})}function G(e){const t=i(!1);return g(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const B=()=>{var e;const{scopeId:t}=((e=R())==null?void 0:e.vnode)||{};return t?{[t]:""}:null},[Ce,we]=K("overlay"),Pe={show:Boolean,zIndex:k,duration:k,className:N,lockScroll:b,lazyRender:b,customStyle:Object};var Se=X({name:Ce,props:Pe,setup(e,{slots:t}){const o=i(),r=G(()=>e.show||!e.lazyRender),n=a=>{e.lockScroll&&p(a,!0)},l=r(()=>{var a;const c=z(oe(e.zIndex),e.customStyle);return M(e.duration)&&(c.animationDuration="".concat(e.duration,"s")),j(h("div",{ref:o,style:c,class:[we(),e.className]},[(a=t.default)==null?void 0:a.call(t)]),[[H,e.show]])});return $("touchmove",n,{target:o}),()=>h(F,{name:"van-fade",appear:!0},{default:l})}});const ke=V(Se),Te=z({},me,{round:Boolean,position:x("center"),closeIcon:x("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:x("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[xe,L]=K("popup");var ze=X({name:xe,inheritAttrs:!1,props:Te,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:r}){let n,l;const a=i(),c=i(),C=G(()=>e.show||!e.lazyRender),O=ne(()=>{const s={zIndex:a.value};if(M(e.duration)){const y=e.position==="center"?"animationDuration":"transitionDuration";s[y]="".concat(e.duration,"s")}return s}),u=()=>{n||(n=!0,a.value=e.zIndex!==void 0?+e.zIndex:de(),t("open"))},m=()=>{n&&ve(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},P=s=>{t("clickOverlay",s),e.closeOnClickOverlay&&m()},d=()=>{if(e.overlay)return h(ke,_({show:e.show,class:e.overlayClass,zIndex:a.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},B(),{onClick:P}),{default:r["overlay-content"]})},v=s=>{t("clickCloseIcon",s),m()},I=()=>{if(e.closeable)return h(ye,{role:"button",tabindex:0,name:e.closeIcon,class:[L("close-icon",e.closeIconPosition),fe],classPrefix:e.iconPrefix,onClick:v},null)};let f;const U=()=>{f&&clearTimeout(f),f=setTimeout(()=>{t("opened")})},Z=()=>t("closed"),q=s=>t("keydown",s),J=C(()=>{var s;const{round:y,position:S,safeAreaInsetTop:T,safeAreaInsetBottom:Q}=e;return j(h("div",_({ref:c,style:O.value,role:"dialog",tabindex:0,class:[L({round:y,[S]:S}),{"van-safe-area-top":T,"van-safe-area-bottom":Q}],onKeydown:q},o,B()),[(s=r.default)==null?void 0:s.call(r),I()]),[[H,e.show]])}),E=()=>{const{position:s,transition:y,transitionAppear:S}=e,T=s==="center"?"van-fade":"van-popup-slide-".concat(s);return h(F,{name:y||T,appear:S,onAfterEnter:U,onAfterLeave:Z},{default:J})};return g(()=>e.show,s=>{s&&!n&&(u(),o.tabindex===0&&ae(()=>{var y;(y=c.value)==null||y.focus()})),!s&&n&&(n=!1,t("close"))}),he({popupRef:c}),be(c,()=>e.show&&e.lockScroll),$("popstate",()=>{e.closeOnPopstate&&(m(),l=!1)}),se(()=>{e.show&&u()}),le(()=>{l&&(t("update:show",!0),l=!1)}),Y(()=>{e.show&&e.teleport&&(m(),l=!0)}),ce(re,()=>e.show),()=>e.teleport?h(ie,{to:e.teleport},{default:()=>[d(),E()]}):h(ue,null,[d(),E()])}});const Ee=V(ze);export{Ee as P,Oe as a,B as b,me as p,he as u};
