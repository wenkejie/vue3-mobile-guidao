System.register(["./index-legacy-C7g6TEdz.js","./index-legacy-yqi55t_a.js","./use-id-legacy-C-0XbuH5.js","./index-legacy-BW_hwWv8.js"],(function(e,t){"use strict";var a,l,r,n,o,i,s,u,c,d,g,f,p,v,m,h,b,y,k,x,S,w,V,C,M,I,B,A,E,z,T,j,P,$,L,W,q,R;return{setters:[e=>{a=e.b1,l=e.b2,r=e.b3,n=e.b4,o=e.aJ,i=e.K,s=e.ai,u=e.T,c=e.a0,d=e.aj,g=e.d,f=e.ak,p=e.r,v=e.ah,m=e.c,h=e.L,b=e.a6,y=e.b5,k=e.w,x=e.J,S=e.q,w=e.an,V=e.g,C=e.R,M=e.a$,I=e.V,B=e.b6,A=e.U,E=e.X,z=e.I,T=e.P,j=e.v,P=e.W,$=e.$},e=>{L=e.c,W=e.C},e=>{q=e.u},e=>{R=e.u}],execute:function(){function t(e){return Array.isArray(e)?!e.length:0!==e&&!e}function F(e,t){const{message:a}=t;return n(a)?a(e,t):a||""}function H({target:e}){e.composing=!0}function D({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function J(e){return[...e].length}function K(e,t){return[...e].slice(0,t).join("")}const[O,U]=i("field"),X=e("f",{id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:u,formatter:Function,clearIcon:c("clear"),modelValue:C(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:c("focus"),formatTrigger:c("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}}),G=s({},L,X,{rows:u,type:c("text"),rules:Array,autosize:[Boolean,Object],labelWidth:u,labelClass:d,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var N=g({name:O,props:G,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:i}){const s=q(),u=f({status:"unvalidated",focused:!1,validateMessage:""}),c=p(),d=p(),g=p(),{parent:C}=v(M),$=()=>{var t;return String(null!=(t=e.modelValue)?t:"")},L=t=>I(e[t])?e[t]:C&&I(C.props[t])?C.props[t]:void 0,O=m((()=>{const t=L("readonly");if(e.clearable&&!t){const t=""!==$(),a="always"===e.clearTrigger||"focus"===e.clearTrigger&&u.focused;return t&&a}return!1})),X=m((()=>g.value&&i.input?g.value():e.modelValue)),G=m((()=>{var t;const a=L("required");return"auto"===a?null==(t=e.rules)?void 0:t.some((e=>e.required)):a})),N=e=>e.reduce(((e,a)=>e.then((()=>{if("failed"===u.status)return;let{value:e}=X;if(a.formatter&&(e=a.formatter(e,a)),!function(e,a){if(t(e)){if(a.required)return!1;if(!1===a.validateEmpty)return!0}return!(a.pattern&&!a.pattern.test(String(e)))}(e,a))return u.status="failed",void(u.validateMessage=F(e,a));if(a.validator){if(t(e)&&!1===a.validateEmpty)return;return function(e,t){return new Promise((a=>{const l=t.validator(e,t);r(l)?l.then(a):a(l)}))}(e,a).then((t=>{t&&"string"==typeof t?(u.status="failed",u.validateMessage=t):!1===t&&(u.status="failed",u.validateMessage=F(e,a))}))}}))),Promise.resolve()),Q=()=>{u.status="unvalidated",u.validateMessage=""},Y=()=>n("endValidate",{status:u.status,message:u.validateMessage}),Z=(t=e.rules)=>new Promise((a=>{Q(),t?(n("startValidate"),N(t).then((()=>{"failed"===u.status?(a({name:e.name,message:u.validateMessage}),Y()):(u.status="passed",a(),Y())}))):a()})),_=t=>{if(C&&e.rules){const{validateTrigger:a}=C.props,l=B(a).includes(t),r=e.rules.filter((e=>e.trigger?B(e.trigger).includes(t):l));r.length&&Z(r)}},ee=(t,a="onChange")=>{const l=t;t=(t=>{var a;const{maxlength:l}=e;if(I(l)&&J(t)>+l){const e=$();if(e&&J(e)===+l)return e;const r=null==(a=c.value)?void 0:a.selectionEnd;if(u.focused&&r){const e=[...t],a=e.length-+l;return e.splice(r-a,a),e.join("")}return K(t,+l)}return t})(t);const r=J(l)-J(t);if("number"===e.type||"digit"===e.type){const a="number"===e.type;t=A(t,a,a)}let o=0;if(e.formatter&&a===e.formatTrigger){const{formatter:a,maxlength:r}=e;if(t=a(t),I(r)&&J(t)>+r&&(t=K(t,+r)),c.value&&u.focused){const{selectionEnd:e}=c.value,t=K(l,e);o=J(a(t))-J(t)}}if(c.value&&c.value.value!==t)if(u.focused){let{selectionStart:e,selectionEnd:a}=c.value;if(c.value.value=t,I(e)&&I(a)){const l=J(t);r?(e-=r,a-=r):o&&(e+=o,a+=o),c.value.setSelectionRange(Math.min(e,l),Math.min(a,l))}}else c.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},te=e=>{e.target.composing||ee(e.target.value)},ae=()=>{var e;return null==(e=c.value)?void 0:e.blur()},le=()=>{var e;return null==(e=c.value)?void 0:e.focus()},re=()=>{const t=c.value;"textarea"===e.type&&e.autosize&&t&&function(e,t){const r=a();e.style.height="auto";let n=e.scrollHeight;if(o(t)){const{maxHeight:e,minHeight:a}=t;void 0!==e&&(n=Math.min(n,e)),void 0!==a&&(n=Math.max(n,a))}n&&(e.style.height=`${n}px`,l(r))}(t,e.autosize)},ne=e=>{u.focused=!0,n("focus",e),x(re),L("readonly")&&ae()},oe=e=>{u.focused=!1,ee($(),"onBlur"),n("blur",e),L("readonly")||(_("onBlur"),x(re),P())},ie=e=>n("clickInput",e),se=e=>n("clickLeftIcon",e),ue=e=>n("clickRightIcon",e),ce=m((()=>"boolean"==typeof e.error?e.error:!(!C||!C.props.showError||"failed"!==u.status)||void 0)),de=m((()=>{const e=L("labelWidth"),t=L("labelAlign");if(e&&"top"!==t)return{width:h(e)}})),ge=t=>{13===t.keyCode&&(C&&C.props.submitOnEnter||"textarea"===e.type||E(t),"search"===e.type&&ae()),n("keypress",t)},fe=()=>e.id||`${s}-input`,pe=()=>{const t=U("control",[L("inputAlign"),{error:ce.value,custom:!!i.input,"min-height":"textarea"===e.type&&!e.autosize}]);if(i.input)return V("div",{class:t,onClick:ie},[i.input()]);const a={id:fe(),ref:c,name:e.name,rows:void 0!==e.rows?+e.rows:void 0,class:t,disabled:L("disabled"),readonly:L("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${s}-label`:void 0,onBlur:oe,onFocus:ne,onInput:te,onClick:ie,onChange:D,onKeypress:ge,onCompositionend:D,onCompositionstart:H};return"textarea"===e.type?V("textarea",a,null):V("input",T("number"===(l=e.type)?{type:"text",inputmode:"decimal"}:"digit"===l?{type:"tel",inputmode:"numeric"}:{type:l},a),null);var l},ve=()=>{const t=i["right-icon"];if(e.rightIcon||t)return V("div",{class:U("right-icon"),onClick:ue},[t?t():V(z,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},me=()=>{if(e.showWordLimit&&e.maxlength){const t=J($());return V("div",{class:U("word-limit")},[V("span",{class:U("word-num")},[t]),j("/"),e.maxlength])}},he=()=>{if(C&&!1===C.props.showErrorMessage)return;const t=e.errorMessage||u.validateMessage;if(t){const e=i["error-message"],a=L("errorMessageAlign");return V("div",{class:U("error-message",a)},[e?e({message:t}):t])}},be=()=>[V("div",{class:U("body")},[pe(),O.value&&V(z,{ref:d,name:e.clearIcon,class:U("clear")},null),ve(),i.button&&V("div",{class:U("button")},[i.button()])]),me(),he()];return R({blur:ae,focus:le,validate:Z,formValue:X,resetValidation:Q,getValidationStatus:()=>u.status}),b(y,{customValue:g,resetValidation:Q,validateWithTrigger:_}),k((()=>e.modelValue),(()=>{ee($()),Q(),_("onChange"),x(re)})),S((()=>{ee($(),e.formatTrigger),x(re)})),w("touchstart",(e=>{E(e),n("update:modelValue",""),n("clear",e)}),{target:m((()=>{var e;return null==(e=d.value)?void 0:e.$el}))}),()=>{const t=L("disabled"),a=L("labelAlign"),l=(()=>{const t=i["left-icon"];if(e.leftIcon||t)return V("div",{class:U("left-icon"),onClick:se},[t?t():V(z,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])})();return V(W,{size:e.size,class:U({error:ce.value,disabled:t,[`label-${a}`]:a}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:de.value,valueClass:U("value"),titleClass:[U("label",[a,{required:G.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:l&&"top"!==a?()=>l:null,title:()=>{const t=(()=>{const t=L("labelWidth"),a=L("labelAlign"),l=L("colon")?":":"";return i.label?[i.label(),l]:e.label?V("label",{id:`${s}-label`,for:i.input?void 0:fe(),onClick:e=>{E(e),le()},style:"top"===a&&t?{width:h(t)}:void 0},[e.label+l]):void 0})();return"top"===a?[l,t].filter(Boolean):t||[]},value:be,extra:i.extra})}}});e("F",$(N))}}}));
