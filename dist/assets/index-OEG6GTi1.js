import{L as V,d as W,r as k,a6 as K,am as M,c as D,W as U,av as F,ao as G,g as r,T as O,U as E,S as Q,a3 as Y,ap as _,aw as Z,R as q,A as J,aj as X,ax as ee,ay as oe,al as R,az as te,G as ae,P as ne,Q as se,aA as le,I as re,a0 as B}from"./index-CIq-oMdo.js";import{u as L}from"./use-scope-id-sANgzUDS.js";import{C as ie}from"./index-gofcAkLv.js";import{P as ce}from"./index-DEoV0_af.js";import{u as de}from"./use-id-BlRh9Qoc.js";const[N,y]=V("dropdown-menu"),ue={overlay:O,zIndex:E,duration:Q(.2),direction:Y("down"),activeColor:String,autoLocate:Boolean,closeOnClickOutside:O,closeOnClickOverlay:O,swipeThreshold:E},j=Symbol(N);var pe=W({name:N,props:ue,setup(o,{slots:i}){const c=de(),p=k(),t=k(),d=k(0),{children:n,linkChildren:x}=K(j),f=M(p),v=D(()=>n.some(e=>e.state.showWrapper)),h=D(()=>o.swipeThreshold&&n.length>+o.swipeThreshold),I=D(()=>{if(v.value&&U(o.zIndex))return{zIndex:+o.zIndex+1}}),C=()=>{n.forEach(e=>{e.toggle(!1)})},S=()=>{o.closeOnClickOutside&&C()},g=()=>{if(t.value){const e=_(t);o.direction==="down"?d.value=e.bottom:d.value=Z.value-e.top}},z=()=>{v.value&&g()},T=e=>{n.forEach((a,s)=>{s===e?a.toggle():a.state.showPopup&&a.toggle(!1,{immediate:!0})})},P=(e,a)=>{const{showPopup:s}=e.state,{disabled:l,titleClass:m}=e;return r("div",{id:"".concat(c,"-").concat(a),role:"button",tabindex:l?void 0:0,class:[y("item",{disabled:l,grow:h.value}),{[q]:!l}],onClick:()=>{l||T(a)}},[r("span",{class:[y("title",{down:s===(o.direction==="down"),active:s}),m],style:{color:s?o.activeColor:""}},[r("div",{class:"van-ellipsis"},[e.renderTitle()])])])};return L({close:C}),x({id:c,props:o,offset:d,updateOffset:g}),F(p,S),G("scroll",z,{target:f,passive:!0}),()=>{var e;return r("div",{ref:p,class:y()},[r("div",{ref:t,style:I.value,class:y("bar",{opened:v.value,scrollable:h.value})},[n.map(P)]),(e=i.default)==null?void 0:e.call(i)])}}});const[fe,b]=V("dropdown-item"),ve={title:String,options:oe(),disabled:Boolean,teleport:[String,Object],lazyRender:O,modelValue:R,titleClass:R};var me=W({name:fe,inheritAttrs:!1,props:ve,emits:["open","opened","close","closed","change","update:modelValue"],setup(o,{emit:i,slots:c,attrs:p}){const t=J({showPopup:!1,transition:!0,showWrapper:!1}),d=k(),{parent:n,index:x}=X(j);if(!n)return;const f=e=>()=>i(e),v=f("open"),h=f("close"),I=f("opened"),C=()=>{t.showWrapper=!1,i("closed")},S=e=>{o.teleport&&e.stopPropagation()},g=(e=!t.showPopup,a={})=>{e!==t.showPopup&&(t.showPopup=e,t.transition=!a.immediate,e&&(n.updateOffset(),t.showWrapper=!0))},z=()=>{if(c.title)return c.title();if(o.title)return o.title;const e=o.options.find(a=>a.value===o.modelValue);return e?e.text:""},T=e=>{const{activeColor:a}=n.props,{disabled:s}=e,l=e.value===o.modelValue,m=()=>{s||(t.showPopup=!1,e.value!==o.modelValue&&(i("update:modelValue",e.value),i("change",e.value)))},w=()=>{if(l)return r(re,{class:b("icon"),color:s?void 0:a,name:"success"},null)};return r(ie,{role:"menuitem",key:String(e.value),icon:e.icon,title:e.text,class:b("option",{active:l,disabled:s}),style:{color:l?a:""},tabindex:l?0:-1,clickable:!s,onClick:m},{value:w})},P=()=>{const{offset:e}=n,{autoLocate:a,zIndex:s,overlay:l,duration:m,direction:w,closeOnClickOverlay:H}=n.props,$=le(s);let A=e.value;if(a&&d.value){const u=te(d.value);u&&(A-=_(u).top)}return w==="down"?$.top="".concat(A,"px"):$.bottom="".concat(A,"px"),ae(r("div",se({ref:d,style:$,class:b([w]),onClick:S},p),[r(ce,{show:t.showPopup,"onUpdate:show":u=>t.showPopup=u,role:"menu",class:b("content"),overlay:l,position:w==="down"?"top":"bottom",duration:t.transition?m:0,lazyRender:o.lazyRender,overlayStyle:{position:"absolute"},"aria-labelledby":"".concat(n.id,"-").concat(x.value),closeOnClickOverlay:H,onOpen:v,onClose:h,onOpened:I,onClosed:C},{default:()=>{var u;return[o.options.map(T),(u=c.default)==null?void 0:u.call(c)]}})]),[[ne,t.showWrapper]])};return L({state:t,toggle:g,renderTitle:z}),()=>o.teleport?r(ee,{to:o.teleport},{default:()=>[P()]}):P()}});const ye=B(me),be=B(pe);export{ye as D,be as a};
