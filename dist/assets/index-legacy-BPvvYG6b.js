System.register(["./index-legacy-9OZgdCRp.js","./use-scope-id-legacy-CIAYnXz1.js","./index-legacy-BAGLBGCn.js","./index-legacy-5fz56Dyj.js"],(function(e,t){"use strict";var l,n,o,a,i,s,u,c,r,v,d,p,m,f,h,g,b,x,y,w,H,O,k,T,S,I,N,C,B,D;return{setters:[e=>{l=e.L,n=e.W,o=e.ak,a=e.aS,i=e.d,s=e.U,u=e.aK,c=e.ay,r=e.r,v=e.c,d=e.aj,p=e.aT,m=e.ao,f=e.g,h=e.Y,g=e.R,b=e.S,x=e.T,y=e.a3,w=e.a6,H=e.aU,O=e.w,k=e.aV,T=e.J,S=e.ar,I=e.Q,N=e.aW},e=>{C=e.u},e=>{B=e.L},e=>{D=e.u}],execute:function(){const[t,V,j]=l("picker"),M=e=>e.find((e=>!e.disabled))||e[0];function $(e,t){for(let l=t=a(t,0,e.length);l<e.length;l++)if(!e[l].disabled)return l;for(let l=t-1;l>=0;l--)if(!e[l].disabled)return l;return 0}const P=(e,t,l)=>void 0!==t&&!!e.find((e=>e[l.value]===t));function E(e,t,l){const n=e.findIndex((e=>e[l.value]===t));return e[$(e,n)]}const[L,A]=l("picker-column"),F=Symbol(L);var U=i({name:L,props:{value:s,fields:u(Object),options:c(),readonly:Boolean,allowHtml:Boolean,optionHeight:u(Number),swipeDuration:u(s),visibleOptionNum:u(s)},emits:["change","clickOption","scrollInto"],setup(e,{emit:t,slots:l}){let n,o,i,s,u;const c=r(),g=r(),b=r(0),x=r(0),y=D(),w=()=>e.options.length,H=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,O=l=>{let o=$(e.options,l);const a=-o*e.optionHeight,i=()=>{o>w()-1&&(o=$(e.options,l));const n=e.options[o][e.fields.value];n!==e.value&&t("change",n)};n&&a!==b.value?u=i:i(),b.value=a},k=()=>e.readonly||!e.options.length,T=t=>a(Math.round(-t/e.optionHeight),0,w()-1),S=v((()=>T(b.value))),I=()=>{n=!1,x.value=0,u&&(u(),u=null)},N=e=>{if(!k()){if(y.start(e),n){const e=function(e){const{transform:t}=window.getComputedStyle(e),l=t.slice(7,t.length-1).split(", ")[5];return Number(l)}(g.value);b.value=Math.min(0,e-H())}x.value=0,o=b.value,i=Date.now(),s=o,u=null}},B=()=>{if(k())return;const t=b.value-s,l=Date.now()-i;if(l<300&&Math.abs(t)>15)return void((t,l)=>{const n=Math.abs(t/l);t=b.value+n/.003*(t<0?-1:1);const o=T(t);x.value=+e.swipeDuration,O(o)})(t,l);const o=T(b.value);x.value=200,O(o),setTimeout((()=>{n=!1}),0)},V=()=>{const o={height:`${e.optionHeight}px`};return e.options.map(((a,i)=>{const s=a[e.fields.text],{disabled:c}=a,r=a[e.fields.value],v={role:"button",style:o,tabindex:c?-1:0,class:[A("item",{disabled:c,selected:r===e.value}),a.className],onClick:()=>(l=>{n||k()||(u=null,x.value=200,O(l),t("clickOption",e.options[l]))})(i)},d={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:s};return f("li",v,[l.option?l.option(a,i):f("div",d,null)])}))};return d(F),C({stopMomentum:I}),p((()=>{const t=n?Math.floor(-b.value/e.optionHeight):e.options.findIndex((t=>t[e.fields.value]===e.value)),l=$(e.options,t),o=-l*e.optionHeight;n&&l<t&&I(),b.value=o})),m("touchmove",(l=>{if(k())return;y.move(l),y.isVertical()&&(n=!0,h(l,!0));const u=a(o+y.deltaY.value,-w()*e.optionHeight,e.optionHeight),c=T(u);c!==S.value&&t("scrollInto",e.options[c]),b.value=u;const r=Date.now();r-i>300&&(i=r,s=u)}),{target:c}),()=>f("div",{ref:c,class:A(),onTouchstartPassive:N,onTouchend:B,onTouchcancel:B},[f("ul",{ref:g,style:{transform:`translate3d(0, ${b.value+H()}px, 0)`,transitionDuration:`${x.value}ms`,transitionProperty:x.value?"all":"none"},class:A("wrapper"),onTransitionend:I},[V()])])}});const[W]=l("picker-toolbar"),Y={title:String,cancelButtonText:String,confirmButtonText:String},z=["cancel","confirm","title","toolbar"],J=Object.keys(Y);var K=i({name:W,props:Y,emits:["confirm","cancel"],setup(e,{emit:t,slots:l}){const n=()=>t("cancel"),o=()=>t("confirm"),a=()=>{var t;const o=null!=(t=e.cancelButtonText)?t:j("cancel");if(l.cancel||o)return f("button",{type:"button",class:[V("cancel"),g],onClick:n},[l.cancel?l.cancel():o])},i=()=>{var t;const n=null!=(t=e.confirmButtonText)?t:j("confirm");if(l.confirm||n)return f("button",{type:"button",class:[V("confirm"),g],onClick:o},[l.confirm?l.confirm():n])};return()=>f("div",{class:V("toolbar")},[l.toolbar?l.toolbar():[a(),l.title?l.title():e.title?f("div",{class:[V("title"),"van-ellipsis"]},[e.title]):void 0,i()]])}});const[Q,R]=l("picker-group"),q=Symbol(Q);o({tabs:c(),activeTab:b(0),nextStepText:String},Y);const G=e("p",o({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:b(44),showToolbar:x,swipeDuration:b(1e3),visibleOptionNum:b(6)},Y)),X=o({},G,{columns:c(),modelValue:c(),toolbarPosition:y("top"),columnsFieldNames:Object});e("s",i({name:t,props:X,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:t,slots:l}){const a=r(),i=r(e.modelValue.slice(0)),{parent:s}=d(q),{children:u,linkChildren:c}=w(F);c();const p=v((()=>function(e){return o({text:"text",value:"value",children:"children"},e)}(e.columnsFieldNames))),g=v((()=>H(e.optionHeight))),b=v((()=>function(e,t){const l=e[0];if(l){if(Array.isArray(l))return"multiple";if(t.children in l)return"cascade"}return"default"}(e.columns,p.value))),x=v((()=>{const{columns:t}=e;switch(b.value){case"multiple":return t;case"cascade":return function(e,t,l){const o=[];let a={[t.children]:e},i=0;for(;a&&a[t.children];){const e=a[t.children],s=l.value[i];a=n(s)?E(e,s,t):void 0,!a&&e.length&&(a=E(e,M(e)[t.value],t)),i++,o.push(e)}return o}(t,p.value,i);default:return[t]}})),y=v((()=>x.value.some((e=>e.length)))),D=v((()=>x.value.map(((e,t)=>E(e,i.value[t],p.value))))),j=v((()=>x.value.map(((e,t)=>e.findIndex((e=>e[p.value.value]===i.value[t])))))),$=(e,t)=>{if(i.value[e]!==t){const l=i.value.slice(0);l[e]=t,i.value=l}},L=()=>({selectedValues:i.value.slice(0),selectedOptions:D.value,selectedIndexes:j.value}),A=()=>{u.forEach((e=>e.stopMomentum()));const e=L();return T((()=>{t("confirm",e)})),e},W=()=>t("cancel",L()),Y=()=>x.value.map(((n,a)=>f(U,{value:i.value[a],fields:p.value,options:n,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:g.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:e=>((e,l)=>{$(l,e),"cascade"===b.value&&i.value.forEach(((e,t)=>{const l=x.value[t];P(l,e,p.value)||$(t,l.length?l[0][p.value.value]:void 0)})),T((()=>{t("change",o({columnIndex:l},L()))}))})(e,a),onClickOption:e=>((e,l)=>{const n={columnIndex:l,currentOption:e};t("clickOption",o(L(),n)),t("scrollInto",n)})(e,a),onScrollInto:e=>{t("scrollInto",{currentOption:e,columnIndex:a})}},{option:l.option}))),Q=e=>{if(y.value){const t={height:`${g.value}px`},l={backgroundSize:`100% ${(e-g.value)/2}px`};return[f("div",{class:V("mask"),style:l},null),f("div",{class:[N,V("frame")],style:t},null)]}},R=()=>{const t=g.value*+e.visibleOptionNum,l={height:`${t}px`};return f("div",{ref:a,class:V("columns"),style:l},[Y(),Q(t)])},G=()=>{if(e.showToolbar&&!s)return f(K,I(S(e,J),{onConfirm:A,onCancel:W}),S(l,z))};let X;return O(x,(e=>{e.forEach(((e,t)=>{e.length&&!P(e,i.value[t],p.value)&&$(t,M(e)[p.value.value])}))}),{immediate:!0}),O((()=>e.modelValue),(e=>{k(e,i.value)||k(e,X)||(i.value=e.slice(0),X=e.slice(0))}),{deep:!0}),O(i,(l=>{k(l,e.modelValue)||(X=l.slice(0),t("update:modelValue",X))}),{immediate:!0}),m("touchmove",h,{target:a}),C({confirm:A,getSelectedOptions:()=>D.value}),()=>{var t,n;return f("div",{class:V()},["top"===e.toolbarPosition?G():null,e.loading?f(B,{class:V("loading")},null):null,null==(t=l["columns-top"])?void 0:t.call(l),R(),null==(n=l["columns-bottom"])?void 0:n.call(l),"bottom"===e.toolbarPosition?G():null])}}}))}}}));
