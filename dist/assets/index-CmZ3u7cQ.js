import{ah as q,L as _,d as y,r as m,am as D,c as K,w as P,an as U,q as M,ao as Y,g as c,S as H,a3 as E,T as B,J,ap as R,aq as Q,a0 as A,ak as F,ar as w,Q as z,Y as G}from"./index-CIq-oMdo.js";import{u as N}from"./use-scope-id-sANgzUDS.js";import{L as W}from"./index-s7_3JXei.js";import{f as V,F as X}from"./index-CfBzFnno.js";import{u as Z}from"./use-id-BlRh9Qoc.js";const p=Symbol(),ee=()=>q(p,null),[ne,f,ae]=_("list"),te={error:Boolean,offset:H(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:E("down"),loadingText:String,finishedText:String,immediateCheck:B};var oe=y({name:ne,props:te,emits:["load","update:error","update:loading"],setup(e,{emit:t,slots:a}){const i=m(e.loading),h=m(),d=m(),u=ee(),x=D(h),g=K(()=>e.scroller||x.value),r=()=>{J(()=>{if(i.value||e.finished||e.disabled||e.error||(u==null?void 0:u.value)===!1)return;const{direction:o}=e,s=+e.offset,l=R(g);if(!l.height||Q(h))return;let b=!1;const k=R(d);o==="up"?b=l.top-k.top<=s:b=k.bottom-l.bottom<=s,b&&(i.value=!0,t("update:loading",!0),t("load"))})},T=()=>{if(e.finished){const o=a.finished?a.finished():e.finishedText;if(o)return c("div",{class:f("finished-text")},[o])}},C=()=>{t("update:error",!1),r()},I=()=>{if(e.error){const o=a.error?a.error():e.errorText;if(o)return c("div",{role:"button",class:f("error-text"),tabindex:0,onClick:C},[o])}},S=()=>{if(i.value&&!e.finished&&!e.disabled)return c("div",{class:f("loading")},[a.loading?a.loading():c(W,{class:f("loading-icon")},{default:()=>[e.loadingText||ae("loading")]})])};return P(()=>[e.loading,e.finished,e.error],r),u&&P(u,o=>{o&&r()}),U(()=>{i.value=e.loading}),M(()=>{e.immediateCheck&&r()}),N({check:r}),Y("scroll",r,{target:g,passive:!0}),()=>{var o;const s=(o=a.default)==null?void 0:o.call(a),l=c("div",{ref:d,class:f("placeholder")},null);return c("div",{ref:h,role:"feed",class:f(),"aria-busy":i.value},[e.direction==="down"?s:l,S(),T(),I(),e.direction==="up"?s:l])}}});const ge=A(oe),[ce,v,re]=_("search"),le=F({},V,{label:String,shape:E("square"),leftIcon:E("search"),clearable:B,actionText:String,background:String,showAction:Boolean});var ie=y({name:ce,props:le,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:a,attrs:i}){const h=Z(),d=m(),u=()=>{a.action||(t("update:modelValue",""),t("cancel"))},x=n=>{n.keyCode===13&&(G(n),t("search",e.modelValue))},g=()=>e.id||"".concat(h,"-input"),r=()=>{if(a.label||e.label)return c("label",{class:v("label"),for:g()},[a.label?a.label():e.label])},T=()=>{if(e.showAction){const n=e.actionText||re("cancel");return c("div",{class:v("action"),role:"button",tabindex:0,onClick:u},[a.action?a.action():n])}},C=()=>{var n;return(n=d.value)==null?void 0:n.blur()},I=()=>{var n;return(n=d.value)==null?void 0:n.focus()},S=n=>t("blur",n),o=n=>t("focus",n),s=n=>t("clear",n),l=n=>t("clickInput",n),b=n=>t("clickLeftIcon",n),k=n=>t("clickRightIcon",n),$=Object.keys(V),O=()=>{const n=F({},i,w(e,$),{id:g()}),L=j=>t("update:modelValue",j);return c(X,z({ref:d,type:"search",class:v("field",{"with-message":n.errorMessage}),border:!1,onBlur:S,onFocus:o,onClear:s,onKeypress:x,onClickInput:l,onClickLeftIcon:b,onClickRightIcon:k,"onUpdate:modelValue":L},n),w(a,["left-icon","right-icon"]))};return N({focus:I,blur:C}),()=>{var n;return c("div",{class:v({"show-action":e.showAction}),style:{background:e.background}},[(n=a.left)==null?void 0:n.call(a),c("div",{class:v("content",e.shape)},[r(),O()]),T()])}}});const be=A(ie);export{ge as L,be as S};
