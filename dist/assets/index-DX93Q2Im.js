import{af as j,K as _,d as y,r as k,al as q,c as D,w as R,am as U,q as M,an as H,g as c,R as J,a0 as P,S as B,J as X,ao as L,ap as Y,$ as A,ai as F,aq as w,P as z,X as G}from"./index-Ti0Ywde6.js";import{u as N}from"./index-DG-rwu-t.js";import{L as Q}from"./index-C4CADt03.js";import{f as V,F as W}from"./index-B-Ff8Pz7.js";import{u as Z}from"./use-id-DLJohKva.js";const p=Symbol(),ee=()=>j(p,null),[ne,f,ae]=_("list"),te={error:Boolean,offset:J(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:P("down"),loadingText:String,finishedText:String,immediateCheck:B};var oe=y({name:ne,props:te,emits:["load","update:error","update:loading"],setup(e,{emit:t,slots:a}){const i=k(e.loading),h=k(),d=k(),u=ee(),x=q(h),g=D(()=>e.scroller||x.value),r=()=>{X(()=>{if(i.value||e.finished||e.disabled||e.error||(u==null?void 0:u.value)===!1)return;const{direction:o}=e,s=+e.offset,l=L(g);if(!l.height||Y(h))return;let b=!1;const m=L(d);o==="up"?b=l.top-m.top<=s:b=m.bottom-l.bottom<=s,b&&(i.value=!0,t("update:loading",!0),t("load"))})},C=()=>{if(e.finished){const o=a.finished?a.finished():e.finishedText;if(o)return c("div",{class:f("finished-text")},[o])}},I=()=>{t("update:error",!1),r()},T=()=>{if(e.error){const o=a.error?a.error():e.errorText;if(o)return c("div",{role:"button",class:f("error-text"),tabindex:0,onClick:I},[o])}},S=()=>{if(i.value&&!e.finished&&!e.disabled)return c("div",{class:f("loading")},[a.loading?a.loading():c(Q,{class:f("loading-icon")},{default:()=>[e.loadingText||ae("loading")]})])};return R(()=>[e.loading,e.finished,e.error],r),u&&R(u,o=>{o&&r()}),U(()=>{i.value=e.loading}),M(()=>{e.immediateCheck&&r()}),N({check:r}),H("scroll",r,{target:g,passive:!0}),()=>{var o;const s=(o=a.default)==null?void 0:o.call(a),l=c("div",{ref:d,class:f("placeholder")},null);return c("div",{ref:h,role:"feed",class:f(),"aria-busy":i.value},[e.direction==="down"?s:l,S(),C(),T(),e.direction==="up"?s:l])}}});const ge=A(oe),[ce,v,re]=_("search"),le=F({},V,{label:String,shape:P("square"),leftIcon:P("search"),clearable:B,actionText:String,background:String,showAction:Boolean});var ie=y({name:ce,props:le,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:a,attrs:i}){const h=Z(),d=k(),u=()=>{a.action||(t("update:modelValue",""),t("cancel"))},x=n=>{n.keyCode===13&&(G(n),t("search",e.modelValue))},g=()=>e.id||"".concat(h,"-input"),r=()=>{if(a.label||e.label)return c("label",{class:v("label"),for:g()},[a.label?a.label():e.label])},C=()=>{if(e.showAction){const n=e.actionText||re("cancel");return c("div",{class:v("action"),role:"button",tabindex:0,onClick:u},[a.action?a.action():n])}},I=()=>{var n;return(n=d.value)==null?void 0:n.blur()},T=()=>{var n;return(n=d.value)==null?void 0:n.focus()},S=n=>t("blur",n),o=n=>t("focus",n),s=n=>t("clear",n),l=n=>t("clickInput",n),b=n=>t("clickLeftIcon",n),m=n=>t("clickRightIcon",n),$=Object.keys(V),K=()=>{const n=F({},i,w(e,$),{id:g()}),E=O=>t("update:modelValue",O);return c(W,z({ref:d,type:"search",class:v("field",{"with-message":n.errorMessage}),border:!1,onBlur:S,onFocus:o,onClear:s,onKeypress:x,onClickInput:l,onClickLeftIcon:b,onClickRightIcon:m,"onUpdate:modelValue":E},n),w(a,["left-icon","right-icon"]))};return N({focus:T,blur:I}),()=>{var n;return c("div",{class:v({"show-action":e.showAction}),style:{background:e.background}},[(n=a.left)==null?void 0:n.call(a),c("div",{class:v("content",e.shape)},[r(),K()]),C()])}}});const be=A(ie);export{ge as L,be as S};
